name: Build

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    name: Build
    runs-on: self-hosted

    steps:
      # -------------------------
      # Checkout code
      # -------------------------
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # -------------------------
      # Setup Python
      # -------------------------
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.x"

      # -------------------------
      # Install detect-secrets
      # -------------------------
      - name: Install detect-secrets
        run: |
          pip install detect-secrets

      # -------------------------
      # üîê SECRET SCAN (FAIL CI/CD IF FOUND)
      # -------------------------
      - name: Run secret scan
        run: |
          detect-secrets scan --baseline .secrets.baseline --fail-on-unaudited

      # -------------------------
      # Your normal build steps
      # -------------------------
      - name: Continue build
        run: |
          echo "‚úÖ No secrets found. Build can continue..."
